<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keranjang Belanja - Grosir Baleendah</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 10px;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
      color: #df0901;
      font-size: 22px;
      margin-bottom: 15px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    /* Item cart */
    .cart-item {
      display: flex;
      flex-direction: column; /* isi ke bawah */
      align-items: center;
      text-align: center;
      gap: 8px;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin-bottom: 12px;
      background: #fff;
    }
    .cart-item img {
      width: 120px; height: 120px;
      object-fit: cover;
      border-radius: 6px;
    }
    .item-info h3 {
      margin: 6px 0;
      font-size: 15px;
    }
    .item-info p {
      margin: 4px 0;
      font-size: 13px;
    }
    .item-actions {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 8px;
    }
    .item-actions input {
      width: 60px;
      padding: 6px;
      border: 1px solid #ccc;
      border-radius: 4px;
      text-align: center;
    }
    .item-actions button {
      padding: 6px 12px;
      background: #e74c3c;
      border: none;
      color: #fff;
      border-radius: 4px;
      cursor: pointer;
    }

    /* Box total */
    .total-box {
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 8px;
      padding: 12px;
      margin: 8px 0;
      font-weight: bold;
    }

    /* Form checkout */
    form {
      background: #fff;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 8px;
      margin-top: 15px;
    }
    label {
      display: block;
      margin-top: 10px;
      font-size: 14px;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 4px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    .payment-info {
      display: none;
      margin-top: 10px;
      background: #fef8e7;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #ddd;
    }
    button.checkout {
      margin-top: 15px;
      width: 100%;
      padding: 12px;
      background: #27ae60;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }
    button.checkout:hover {
      background: #219150;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Keranjang Belanja</h1>
    <div id="cartList"></div>

    <div class="total-box" id="totalBox">Total: Rp 0</div>
    <div class="total-box" id="ongkirBox">Ongkir: Rp 0</div>
    <div class="total-box" id="grandTotalBox">Total Bayar: Rp 0</div>

    <!-- Form checkout -->
    <form id="checkoutForm">
      <label>Nama Lengkap</label>
      <input type="text" id="nama" required>

      <label>Alamat</label>
      <input type="text" id="alamat" required>

      <label>No HP</label>
      <input type="text" id="hp" required>

      <label>Kecamatan</label>
      <select id="kecamatan" required>
        <option value="">-- Pilih Kecamatan --</option>
        <option value="Baleendah">Baleendah - Rp 10.000</option>
        <option value="Banjaran">Banjaran - Rp 12.000</option>
        <option value="Dayeuhkolot">Dayeuhkolot - Rp 15.000</option>
      </select>

      <label>Pilih Pembayaran</label>
      <select id="pembayaran" required>
        <option value="COD">COD (Bayar di tempat)</option>
        <option value="Transfer">Transfer</option>
      </select>

      <div class="payment-info" id="rekeningInfo">
        <p><b>Transfer ke rekening:</b></p>
        <p>BCA: 3371777626</p>
        <p>Mandiri: 130006</p>
      </div>

      <button type="submit" class="checkout">Checkout via WhatsApp</button>
    </form>
  </div>

  <script>
    // Ongkir mapping
    const ongkirMap = {
      "Baleendah": 10000,
      "Banjaran": 12000,
      "Dayeuhkolot": 15000
    };

    // Load cart
    let cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartList = document.getElementById("cartList");
    const totalBox = document.getElementById("totalBox");
    const ongkirBox = document.getElementById("ongkirBox");
    const grandTotalBox = document.getElementById("grandTotalBox");
    const kecamatanSelect = document.getElementById("kecamatan");
    const rekeningInfo = document.getElementById("rekeningInfo");

    function renderCart() {
      cartList.innerHTML = "";
      let total = 0;
      cart.forEach((item, index) => {
        const subtotal = item.harga * item.qty;
        total += subtotal;

        const div = document.createElement("div");
        div.className = "cart-item";
        div.innerHTML = `
          <img src="${item.gambar}" alt="${item.nama}">
          <div class="item-info">
            <h3>${item.nama}</h3>
            <p>Harga: Rp ${item.harga.toLocaleString()}</p>
            <p>Subtotal: Rp ${(subtotal).toLocaleString()}</p>
          </div>
          <div class="item-actions">
            <input type="number" min="1" value="${item.qty}" onchange="updateQty(${index}, this.value)">
            <button onclick="removeItem(${index})">Hapus</button>
          </div>
        `;
        cartList.appendChild(div);
      });

      updateTotal(total);
    }

    function updateTotal(total) {
      totalBox.textContent = "Total: Rp " + total.toLocaleString();
      const kecamatan = kecamatanSelect.value;
      const ongkir = kecamatan ? (ongkirMap[kecamatan] || 0) : 0;
      ongkirBox.textContent = "Ongkir: Rp " + ongkir.toLocaleString();
      grandTotalBox.textContent = "Total Bayar: Rp " + (total + ongkir).toLocaleString();
    }

    function updateQty(index, qty) {
      cart[index].qty = parseInt(qty);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    function removeItem(index) {
      cart.splice(index, 1);
      localStorage.setItem("cart", JSON.stringify(cart));
      renderCart();
    }

    // onchange kecamatan
    kecamatanSelect.addEventListener("change", () => {
      let total = cart.reduce((sum, item) => sum + item.harga * item.qty, 0);
      updateTotal(total);
    });

    // onchange pembayaran
    document.getElementById("pembayaran").addEventListener("change", function() {
      if (this.value === "Transfer") {
        rekeningInfo.style.display = "block";
      } else {
        rekeningInfo.style.display = "none";
      }
    });

    // Checkout form
    document.getElementById("checkoutForm").addEventListener("submit", function(e) {
      e.preventDefault();
      let nama = document.getElementById("nama").value;
      let alamat = document.getElementById("alamat").value;
      let hp = document.getElementById("hp").value;
      let kecamatan = kecamatanSelect.value;
      let pembayaran = document.getElementById("pembayaran").value;

      let total = cart.reduce((sum, item) => sum + item.harga * item.qty, 0);
      let ongkir = kecamatan ? (ongkirMap[kecamatan] || 0) : 0;
      let grandTotal = total + ongkir;

      let pesan = `Halo, saya ingin pesan:%0A`;
      cart.forEach(item => {
        pesan += `- ${item.nama} x${item.qty} = Rp ${(item.harga*item.qty).toLocaleString()}%0A`;
      });
      pesan += `Total: Rp ${total.toLocaleString()}%0A`;
      pesan += `Ongkir (${kecamatan}): Rp ${ongkir.toLocaleString()}%0A`;
      pesan += `Total Bayar: Rp ${grandTotal.toLocaleString()}%0A%0A`;
      pesan += `Nama: ${nama}%0AAlamat: ${alamat}%0AHP: ${hp}%0A`;
      pesan += `Pembayaran: ${pembayaran}`;

      window.open(`https://wa.me/628997944479?text=${pesan}`, "_blank");
    });

    renderCart();
  </script>
</body>
</html>




