<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>grosirbaleendah.com</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#040218; }
    header { background:#2c3e50; color:white; text-align:center; padding:5px; }
    header h1 { margin:0; }
    marquee { color:yellow; font-weight:bold; }
    nav { background:#34495e; display:flex; flex-wrap:wrap; justify-content:center; }
    nav button { background:none; border:none; color:white; padding:10px 15px; cursor:pointer; }
    nav button:hover { background:#2c3e50; }
    #controls { display:flex; justify-content:center; gap:10px; margin:10px; }
    #controls input, #controls select { padding:5px; }
    #products { display:grid; grid-template-columns: repeat(auto-fit,minmax(200px,1fr)); gap:15px; padding:15px; }
    .product { background:white; padding:10px; border-radius:8px; text-align:center; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .product img { max-width:100%; border-radius:8px; }
    .product button { margin-top:8px; padding:6px 10px; }
    #cart { position:fixed; right:0; top:0; width:320px; height:100%; background:white; border-left:2px solid #ccc; padding:10px; overflow:auto; }
    #cart h2 { text-align:center; }
    .cart-item { display:flex; justify-content:space-between; margin:5px 0; }
    .pagination { text-align:center; margin:10px; }
    .pagination button { margin:2px; padding:5px 10px; }
    #checkout { margin-top:10px; }
    #checkout input, #checkout select { width:95%; margin-bottom:8px; padding:5px; }
  </style>
</head>
<body>

<header>
  <h1>GROSIR BALEENDAH</h1>
  <h4>WA 08997944479</h4>
  <marquee>Belanja mudah, belanja cepat, cepat cuan!</marquee>
</header>

<nav id="categoryNav"></nav>

<div id="controls">
  <input type="text" id="search" placeholder="Cari produk...">
  <select id="sort">
    <option value="">Urutkan</option>
    <option value="asc">Harga Termurah</option>
    <option value="desc">Harga Termahal</option>
    <option value="new">Produk Terbaru</option>
  </select>
</div>

<div id="products"></div>
<div class="pagination" id="pagination"></div>

<aside id="cart">
  <h2>Keranjang</h2>
  <div id="cartItems"></div>
  <p id="subtotal"></p>
  <div id="checkout">
    <input type="text" id="custName" placeholder="Nama">
    <input type="text" id="custAddr" placeholder="Alamat">
    <input type="text" id="custPhone" placeholder="No HP">
    <select id="kecamatan">
      <option value="">Pilih Kecamatan</option>
      <option value="Baleendah">Baleendah - Rp 10.000</option>
      <option value="Dayeuhkolot">Dayeuhkolot - Rp 12.000</option>
      <option value="Bojongsoang">Bojongsoang - Rp 15.000</option>
      <option value="Cicalengka">Cicalengka - Rp 20.000</option>
      <option value="Kadipaten">Kadipaten - Rp 25.000</option>
    </select>
    
    <!-- Tambahan metode pembayaran -->
    <select id="paymentMethod">
      <option value="">Pilih Metode Pembayaran</option>
      <option value="COD">COD (Bayar di Tempat)</option>
      <option value="Transfer">Transfer Bank</option>
    </select>
    
    <p id="ongkir"></p>
    <p id="total"></p>
    <button onclick="checkout()">Kirim Pesanan via WhatsApp</button>
  </div>
  <h3>Rekening Pembayaran</h3>
  <p>Mandiri: <b>1300062044600</b> a/n Aditia Suryawan</p>
  <p>BCA: <b>3371777626</b> a/n Aditia Suryawan</p>
  <p><u>MOHON LAMPIRKAN BUKTI TRANSFER DI WA JIKA PEMBAYARAN DENGAN TRANSFER</u></p>
</aside>

<script>
const productsData = [
  {id:1, name:"Beras 5kg", price:60000, category:"Sembako", stock:10, img:"https://via.placeholder.com/200"},
  {id:2, name:"Minyak Goreng 2L", price:32000, category:"Sembako", stock:5, img:"https://via.placeholder.com/200"},
  {id:3, name:"Teh Botol", price:5000, category:"Minuman", stock:20, img:"https://via.placeholder.com/200"},
  {id:4, name:"Kopi Sachet", price:2000, category:"Minuman", stock:50, img:"https://via.placeholder.com/200"},
  {id:5, name:"Snack Ring", price:8000, category:"Snack", stock:15, img:"https://via.placeholder.com/200"},
  {id:6, name:"Rokok Filter", price:25000, category:"Roko", stock:10, img:"https://via.placeholder.com/200"},
  {id:7, name:"Paracetamol", price:3000, category:"Obat", stock:25, img:"https://via.placeholder.com/200"},
  {id:8, name:"Sapu", price:20000, category:"Alat Rumah Tangga", stock:8, img:"https://via.placeholder.com/200"},
  {id:9, name:"Lampu LED", price:15000, category:"Alat Listrik", stock:12, img:"https://via.placeholder.com/200"},
];

let cart = JSON.parse(localStorage.getItem("cart")) || [];
let currentPage = 1;
const perPage = 6;
let currentCategory = "";
let searchQuery = "";
let sortOption = "";
let total = 0;

const shippingRates = {
  "Baleendah":10000,
  "Dayeuhkolot":12000,
  "Bojongsoang":15000,
  "Cicalengka":20000,
  "Kadipaten":25000
};

function renderCategories(){
  const nav = document.getElementById("categoryNav");
  const cats = ["Semua", ...new Set(productsData.map(p=>p.category))];
  nav.innerHTML = cats.map(c=>`<button onclick="filterCategory('${c}')">${c}</button>`).join("");
}

function filterCategory(cat){
  currentCategory = (cat==="Semua")?"":cat;
  currentPage = 1;
  renderProducts();
}

function renderProducts(){
  let data = [...productsData];
  if(currentCategory) data = data.filter(p=>p.category===currentCategory);
  if(searchQuery) data = data.filter(p=>p.name.toLowerCase().includes(searchQuery.toLowerCase()));
  if(sortOption==="asc") data.sort((a,b)=>a.price-b.price);
  if(sortOption==="desc") data.sort((a,b)=>b.price-a.price);
  if(sortOption==="new") data.sort((a,b)=>b.id-a.id);

  const totalPages = Math.ceil(data.length/perPage);
  if(currentPage>totalPages) currentPage=totalPages||1;
  const start = (currentPage-1)*perPage;
  const pageData = data.slice(start, start+perPage);

  document.getElementById("products").innerHTML = pageData.map(p=>`
    <div class="product">
      <img src="${p.img}" alt="${p.name}">
      <h4>${p.name}</h4>
      <p>Rp ${p.price.toLocaleString()}</p>
      <p>Stok: ${p.stock}</p>
      <button onclick="addToCart(${p.id})" ${p.stock===0?"disabled":""}>
        ${p.stock===0?"Stok Habis":"+ Keranjang"}
      </button>
    </div>
  `).join("");

  document.getElementById("pagination").innerHTML =
    Array.from({length:totalPages},(_,i)=>`<button onclick="gotoPage(${i+1})">${i+1}</button>`).join("");
}

function gotoPage(p){ currentPage=p; renderProducts(); }

function addToCart(id){
  const prod = productsData.find(p=>p.id===id);
  const existing = cart.find(c=>c.id===id);
  if(existing){
    if(existing.qty >= prod.stock){
      alert("Stok habis untuk produk: "+prod.name);
      return;
    }
    existing.qty++;
  } else {
    if(prod.stock<=0){
      alert("Produk ini sedang kosong!");
      return;
    }
    cart.push({...prod, qty:1});
  }
  saveCart(); renderCart();
}

function renderCart(){
  document.getElementById("cartItems").innerHTML = cart.map((item,i)=>`
    <div class="cart-item">
      <span>${item.name} (x${item.qty})</span>
      <span>
        <input type="number" value="${item.qty}" min="1" style="width:40px"
          onchange="updateQty(${i}, this.value)">
        <button onclick="removeItem(${i})">X</button>
      </span>
    </div>
  `).join("");
  const subtotal = cart.reduce((s,i)=>s+i.price*i.qty,0);
  document.getElementById("subtotal").innerText = "Subtotal: Rp "+subtotal.toLocaleString();
  const kec = document.getElementById("kecamatan").value;
  const ongkir = shippingRates[kec]||0;
  total = subtotal+ongkir;
  document.getElementById("ongkir").innerText = kec?"Ongkir: Rp "+ongkir.toLocaleString():"";
  document.getElementById("total").innerText = "Total: Rp "+total.toLocaleString();
}

function updateQty(index,val){
  const prod = productsData.find(p=>p.id===cart[index].id);
  if(val>prod.stock){
    alert("Stok tersedia hanya "+prod.stock);
    cart[index].qty = prod.stock;
  } else {
    cart[index].qty = parseInt(val);
  }
  saveCart(); renderCart();
}

function removeItem(i){ cart.splice(i,1); saveCart(); renderCart(); }

function saveCart(){ localStorage.setItem("cart",JSON.stringify(cart)); }

document.getElementById("search").addEventListener("input",e=>{ searchQuery=e.target.value; currentPage=1; renderProducts(); });
document.getElementById("sort").addEventListener("change",e=>{ sortOption=e.target.value; renderProducts(); });
document.getElementById("kecamatan").addEventListener("change",renderCart);

function checkout(){
  if(cart.length===0){ alert("Keranjang masih kosong"); return; }
  const name=document.getElementById("custName").value;
  const addr=document.getElementById("custAddr").value;
  const phone=document.getElementById("custPhone").value;
  const kec=document.getElementById("kecamatan").value;
  const payment=document.getElementById("paymentMethod").value;
  if(!name||!addr||!phone||!kec||!payment){ 
    alert("Lengkapi semua data checkout termasuk metode pembayaran"); 
    return; 
  }

  // kurangi stok
  cart.forEach(item=>{
    const prod = productsData.find(p=>p.id===item.id);
    if(prod){ prod.stock -= item.qty; if(prod.stock<0) prod.stock=0; }
  });

  // buat pesan
  let msg=`Halo, saya mau pesan:\n`;
  cart.forEach(item=>{ msg+=`${item.name} x${item.qty} = Rp ${(item.price*item.qty).toLocaleString()}\n`; });
  const subtotal = cart.reduce((s,i)=>s+i.price*i.qty,0);
  msg+=`Subtotal: Rp ${subtotal.toLocaleString()}\n`;
  msg+=`Ongkir ${kec}: Rp ${shippingRates[kec].toLocaleString()}\n`;
  msg+=`Total: Rp ${total.toLocaleString()}\n\n`;
  msg+=`Nama: ${name}\nAlamat: ${addr}\nHP: ${phone}\n`;
  msg+=`Metode Pembayaran: ${payment}`;

  // buka WA
  window.open(`https://wa.me/6285222044600?text=${encodeURIComponent(msg)}`);

  // reset keranjang
  cart=[]; saveCart(); renderCart(); renderProducts();
}

renderCategories(); renderProducts(); renderCart();
</script>

</body>
</html>
